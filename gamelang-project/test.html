<!DOCTYPE html>
<html>
<head>
    <title>Gamelang IDE - –ü–∞—Ä—Å–µ—Ä –∏ Runtime</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        @media (max-width: 1200px) {
            .container {
                grid-template-columns: 1fr;
            }
        }
        
        .panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            color: #333;
        }
        
        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        h2 {
            color: #4a5568;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        
        h3 {
            color: #4a5568;
            margin: 15px 0 10px 0;
        }
        
        textarea {
            width: 100%;
            height: 300px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            resize: vertical;
            background: #f7fafc;
            transition: all 0.3s;
        }
        
        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .buttons {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        button.secondary {
            background: #48bb78;
        }
        
        button.danger {
            background: #f56565;
        }
        
        button.info {
            background: #4299e1;
        }
        
        .result {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            margin-top: 10px;
            max-height: 300px;
            overflow-y: auto;
            border: 2px solid #e2e8f0;
        }
        
        pre {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 12px;
            white-space: pre-wrap;
            word-break: break-all;
            line-height: 1.4;
        }
        
        .success {
            color: #48bb78;
            padding: 10px;
            background: #c6f6d5;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #48bb78;
        }
        
        .error {
            color: #c53030;
            padding: 10px;
            background: #fed7d7;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #c53030;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 15px 0;
        }
        
        .stat-box {
            background: #edf2f7;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            font-size: 12px;
            color: #718096;
            margin-top: 5px;
        }
        
        .examples {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .example-btn {
            background: #e2e8f0;
            color: #4a5568;
            padding: 10px;
            font-size: 14px;
        }
        
        .example-btn:hover {
            background: #cbd5e0;
        }
        
        .code-highlight {
            color: #2d3748;
            font-weight: bold;
        }
        
        .keyword { color: #805ad5; }
        .string { color: #dd6b20; }
        .number { color: #0e9aa7; }
        .comment { color: #718096; font-style: italic; }
        
        .section-divider {
            height: 2px;
            background: linear-gradient(to right, transparent, #667eea, transparent);
            margin: 30px 0;
        }
    </style>
</head>
<body>
    <h1>üéÆ Gamelang IDE - –ü–∞—Ä—Å–µ—Ä –∏ Runtime</h1>
    
    <div class="container">
        <!-- –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨: –†–ï–î–ê–ö–¢–û–† –ò –ü–ê–†–°–ï–† -->
        <div class="panel">
            <h2>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞</h2>
            <textarea id="codeInput" spellcheck="false"># –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç Gamelang
# –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º, –ø–æ–¥—Å–∫–∞–∑–∫–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º

# 1. –°–æ–∑–¥–∞–µ–º —Å–ø—Ä–∞–π—Ç
sprite player "hero.png"

# 2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–≤–æ–π—Å—Ç–≤–∞
player.x = 100
player.y = 200
player.speed = 5.5

# 3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
score = 0
player_name = "–ì–µ—Ä–æ–π"

# 4. –§—É–Ω–∫—Ü–∏—è
function move_right():
    player.x += player.speed
    print("–î–≤–∏–∂–µ–Ω–∏–µ –≤–ø—Ä–∞–≤–æ!")

# 5. –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏
move_right()

# 6. –í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
print("–°–ø—Ä–∞–π—Ç —Å–æ–∑–¥–∞–Ω!")
print("–ò–º—è: " + player_name)
print("–ü–æ–∑–∏—Ü–∏—è: " + player.x + ", " + player.y)
print("–°—á–µ—Ç: " + score)</textarea>
            
            <div class="buttons">
                <button onclick="runParser()">
                    <span>üîç</span> –¢–µ—Å—Ç –ø–∞—Ä—Å–µ—Ä–∞
                </button>
                <button class="secondary" onclick="runRuntime()">
                    <span>üöÄ</span> –ó–∞–ø—É—Å—Ç–∏—Ç—å Runtime
                </button>
                <button class="info" onclick="loadExample('simple')">
                    <span>üß™</span> –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç
                </button>
                <button class="danger" onclick="clearAll()">
                    <span>üóëÔ∏è</span> –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ
                </button>
            </div>
            
            <h3>–ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞:</h3>
            <div class="examples">
                <button class="example-btn" onclick="loadExample('simple')">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π</button>
                <button class="example-btn" onclick="loadExample('function')">–° —Ñ—É–Ω–∫—Ü–∏–µ–π</button>
                <button class="example-btn" onclick="loadExample('game')">–ò–≥—Ä–æ–≤–æ–π</button>
            </div>
        </div>
        
        <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨: –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ü–ê–†–°–ï–†–ê -->
        <div class="panel">
            <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–µ—Ä–∞</h2>
            
            <div id="parserResult">
                <div class="success">
                    ‚úÖ –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é! –ù–∞–∂–º–∏—Ç–µ "–¢–µ—Å—Ç –ø–∞—Ä—Å–µ—Ä–∞"
                </div>
            </div>
            
            <div class="stats" id="parserStats">
                <div class="stat-box">
                    <div class="stat-value" id="statLines">0</div>
                    <div class="stat-label">—Å—Ç—Ä–æ–∫ –∫–æ–¥–∞</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="statTime">0</div>
                    <div class="stat-label">–º—Å</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="statSprites">0</div>
                    <div class="stat-label">—Å–ø—Ä–∞–π—Ç–æ–≤</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="statFunctions">0</div>
                    <div class="stat-label">—Ñ—É–Ω–∫—Ü–∏–π</div>
                </div>
            </div>
            
            <h3>AST —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:</h3>
            <div class="result">
                <pre id="astOutput">–ó–¥–µ—Å—å –±—É–¥–µ—Ç –¥–µ—Ä–µ–≤–æ —Ä–∞–∑–±–æ—Ä–∞ (AST)...</pre>
            </div>
        </div>
    </div>
    
    <!-- –†–ê–ó–î–ï–õ–ò–¢–ï–õ–¨ -->
    <div class="section-divider"></div>
    
    <!-- –ù–ò–ñ–ù–Ø–Ø –ü–ê–ù–ï–õ–¨: RUNTIME -->
    <div class="container">
        <div class="panel" style="grid-column: span 2;">
            <h2>üéÆ Gamelang Runtime (–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å)</h2>
            
            <div class="buttons">
                <button onclick="runRuntime()" style="background: #38a169;">
                    <span>üöÄ</span> –ó–∞–ø—É—Å—Ç–∏—Ç—å Runtime
                </button>
                <button onclick="stopRuntime()" style="background: #e53e3e;">
                    <span>‚èπÔ∏è</span> –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
                </button>
                <button onclick="inspectRuntime()" style="background: #3182ce;">
                    <span>üîç</span> –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                </button>
                <button onclick="clearRuntimeOutput()" style="background: #a0aec0;">
                    <span>üßπ</span> –û—á–∏—Å—Ç–∏—Ç—å –≤—ã–≤–æ–¥
                </button>
            </div>
            
            <div class="result" id="runtimeOutput" style="min-height: 200px;">
                <pre>–ó–¥–µ—Å—å –±—É–¥–µ—Ç –≤—ã–≤–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã...</pre>
            </div>
            
            <div class="stats" id="runtimeStats">
                <div class="stat-box">
                    <div class="stat-value" id="rtSprites">0</div>
                    <div class="stat-label">—Å–ø—Ä–∞–π—Ç–æ–≤</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="rtVariables">0</div>
                    <div class="stat-label">–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="rtFrames">0</div>
                    <div class="stat-label">–∫–∞–¥—Ä–æ–≤</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="rtStatus">‚è∏Ô∏è</div>
                    <div class="stat-label">—Å—Ç–∞—Ç—É—Å</div>
                </div>
            </div>
            
            <h3>–ö–æ–Ω—Å–æ–ª—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:</h3>
            <div class="result" style="min-height: 150px; max-height: 300px;">
                <pre id="runtimeConsole">[–ö–æ–Ω—Å–æ–ª—å –±—É–¥–µ—Ç –∑–¥–µ—Å—å]</pre>
            </div>
        </div>
    </div>
    
    <!-- –ü–û–î–ö–õ–Æ–ß–ê–ï–ú –ü–ê–†–°–ï–† -->
    <script src="src/parser/Parser.js"></script>
    
    <!-- –ü–û–î–ö–õ–Æ–ß–ê–ï–ú RUNTIME -->
    <script src="src/runtime/GameContext.js"></script>
    <script src="src/runtime/Runtime.js"></script>
    
    <script>
        // ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
        let runtimeInstance = null;
        let consoleOutput = [];
        
        // ==================== –ü–†–ò–ú–ï–†–´ –ö–û–î–ê ====================
        const examples = {
            simple: `# –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä
sprite hero "character.png"
hero.x = 100
hero.y = 200

print("–°–ø—Ä–∞–π—Ç —Å–æ–∑–¥–∞–Ω!")
print("–ü–æ–∑–∏—Ü–∏—è: " + hero.x + ", " + hero.y)`,

            function: `# –ü—Ä–∏–º–µ—Ä —Å —Ñ—É–Ω–∫—Ü–∏–µ–π
sprite player "hero.png"
player.x = 100
player.speed = 5

function move():
    player.x += player.speed
    print("–î–≤–∏–∂–µ–Ω–∏–µ! X = " + player.x)

print("–ù–∞—á–∞–ª–æ –ø—Ä–æ–≥—Ä–∞–º–º—ã")
move()
move()
print("–ö–æ–Ω–µ—Ü –ø—Ä–æ–≥—Ä–∞–º–º—ã")`,

            game: `# –ü—Ä–æ—Å—Ç–æ–π –∏–≥—Ä–æ–≤–æ–π –ø—Ä–∏–º–µ—Ä
sprite ship "spaceship.png"
sprite enemy "monster.png"

ship.x = 100
ship.y = 300
ship.speed = 3
ship.health = 100

enemy.x = 500
enemy.y = 300
enemy.speed = 1
enemy.damage = 10

score = 0
lives = 3

function fire():
    print("–í—ã—Å—Ç—Ä–µ–ª!")
    score += 10

function hit():
    ship.health -= enemy.damage
    print("–ü–æ–ø–∞–¥–∞–Ω–∏–µ! –ó–¥–æ—Ä–æ–≤—å–µ: " + ship.health)
    
    if ship.health <= 0:
        print("–ö–æ—Ä–∞–±–ª—å —É–Ω–∏—á—Ç–æ–∂–µ–Ω!")
        lives -= 1

print("–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å!")
print("–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –∫–æ—Ä–∞–±–ª—å –≤ –ø–æ–∑–∏—Ü–∏–∏ " + ship.x + ", " + ship.y)
print("–í—Ä–∞–≥ –≤ –ø–æ–∑–∏—Ü–∏–∏ " + enemy.x + ", " + enemy.y)`
        };
        
        // ==================== –§–£–ù–ö–¶–ò–ò –ü–ê–†–°–ï–†–ê ====================
        
        function runParser() {
            const code = document.getElementById('codeInput').value;
            const parser = new GamelangParser();
            
            try {
                const startTime = performance.now();
                const ast = parser.parse(code);
                const endTime = performance.now();
                const parseTime = (endTime - startTime).toFixed(2);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                updateParserStats(code, parseTime, ast);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö
                document.getElementById('parserResult').innerHTML = `
                    <div class="success">
                        ‚úÖ –ü–∞—Ä—Å–µ—Ä –æ—Ç—Ä–∞–±–æ—Ç–∞–ª —É—Å–ø–µ—à–Ω–æ! –í—Ä–µ–º—è: ${parseTime} –º—Å
                    </div>
                `;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º AST
                displayAST(ast);
                
                // –õ–æ–≥–∏—Ä—É–µ–º –≤ –∫–æ–Ω—Å–æ–ª—å
                console.log("üîç –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞:", ast);
                
            } catch (error) {
                document.getElementById('parserResult').innerHTML = `
                    <div class="error">
                        ‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞: ${error.message}
                        ${error.line ? `<br>–°—Ç—Ä–æ–∫–∞: ${error.line + 1}` : ''}
                    </div>
                `;
                console.error("‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞:", error);
            }
        }
        
        function updateParserStats(code, parseTime, ast) {
            const lines = code.split('\n').filter(l => l.trim() && !l.trim().startsWith('#')).length;
            const spriteCount = ast.body.filter(stmt => stmt.type === 'SpriteDeclaration').length;
            const functionCount = ast.body.filter(stmt => stmt.type === 'FunctionDeclaration').length;
            
            document.getElementById('statLines').textContent = lines;
            document.getElementById('statTime').textContent = parseTime;
            document.getElementById('statSprites').textContent = spriteCount;
            document.getElementById('statFunctions').textContent = functionCount;
        }
        
        function displayAST(ast) {
            const astString = JSON.stringify(ast, null, 2);
            
            // –ü—Ä–æ—Å—Ç–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞
            let highlighted = astString
                .replace(/("type": ")([^"]+)(")/g, '$1<span class="keyword">$2</span>$3')
                .replace(/("value": )(\d+\.?\d*)/g, '$1<span class="number">$2</span>')
                .replace(/("value": ")([^"]+)(")/g, '$1<span class="string">$2</span>$3')
                .replace(/("name": ")([^"]+)(")/g, '$1<span class="code-highlight">$2</span>$3');
            
            document.getElementById('astOutput').innerHTML = highlighted;
        }
        
        // ==================== –§–£–ù–ö–¶–ò–ò RUNTIME ====================
        
        function runRuntime() {
            const code = document.getElementById('codeInput').value;
            const parser = new GamelangParser();
            
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –≤—ã–≤–æ–¥
            consoleOutput = [];
            updateRuntimeConsole();
            
            try {
                // –ü–∞—Ä—Å–∏–º –∫–æ–¥
                const ast = parser.parse(code);
                console.log("üì¶ AST –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:", ast);
                
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π runtime
                if (runtimeInstance) {
                    runtimeInstance.stop();
                }
                
                // –°–æ–∑–¥–∞–µ–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—ã–π runtime
                runtimeInstance = new GamelangRuntime();
                
                // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º console.log –¥–ª—è –≤—ã–≤–æ–¥–∞ –≤ –Ω–∞—à—É –∫–æ–Ω—Å–æ–ª—å
                const originalLog = console.log;
                console.log = function(...args) {
                    originalLog.apply(console, args);
                    const message = args.map(arg => 
                        typeof arg === 'object' ? JSON.stringify(arg) : String(arg)
                    ).join(' ');
                    consoleOutput.push(message);
                    updateRuntimeConsole();
                };
                
                // –í—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—É
                const result = runtimeInstance.execute(ast);
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º console.log
                console.log = originalLog;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                document.getElementById('runtimeOutput').innerHTML = `
                    <div class="success">
                        ‚úÖ RUNTIME –ó–ê–ü–£–©–ï–ù –£–°–ü–ï–®–ù–û!
                    </div>
                    <pre>–í—ã–≤–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã:
${result.getOutput() || "(–Ω–µ—Ç –≤—ã–≤–æ–¥–∞)"}</pre>
                `;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                updateRuntimeStats();
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                setTimeout(inspectRuntime, 500);
                
            } catch (error) {
                document.getElementById('runtimeOutput').innerHTML = `
                    <div class="error">
                        ‚ùå –û–®–ò–ë–ö–ê –í–´–ü–û–õ–ù–ï–ù–ò–Ø
                    </div>
                    <pre>${error.message}

${error.stack || ''}</pre>
                `;
                console.error("‚ùå –û—à–∏–±–∫–∞ Runtime:", error);
            }
        }
        
        function stopRuntime() {
            if (runtimeInstance) {
                runtimeInstance.stop();
                document.getElementById('rtStatus').textContent = '‚è∏Ô∏è';
                document.getElementById('runtimeOutput').innerHTML += `
                    <pre>‚èπÔ∏è Runtime –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</pre>
                `;
                consoleOutput.push("[System] Runtime –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω");
                updateRuntimeConsole();
            }
        }
        
        function inspectRuntime() {
            if (runtimeInstance) {
                const state = runtimeInstance.getState();
                
                let output = "üîç –°–û–°–¢–û–Ø–ù–ò–ï RUNTIME:\n\n";
                output += "üìä –ü–ï–†–ï–ú–ï–ù–ù–´–ï:\n";
                
                // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
                Object.entries(state.variables).forEach(([key, value]) => {
                    if (typeof value === 'object' && value !== null && !Array.isArray(value)) {
                        output += `  ${key}: [–æ–±—ä–µ–∫—Ç]\n`;
                    } else {
                        output += `  ${key}: ${JSON.stringify(value)}\n`;
                    }
                });
                
                output += "\nüé® –°–ü–†–ê–ô–¢–´:\n";
                Object.entries(state.sprites).forEach(([name, sprite]) => {
                    output += `  ${name}: x=${sprite.x}, y=${sprite.y}, image="${sprite.image}"\n`;
                });
                
                output += `\nüìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê:\n`;
                output += `  –§—É–Ω–∫—Ü–∏–π: ${state.functions.length}\n`;
                output += `  –ö–∞–¥—Ä–æ–≤: ${state.frameCount}\n`;
                output += `  –°—Ç–∞—Ç—É—Å: ${state.isRunning ? '‚ñ∂Ô∏è —Ä–∞–±–æ—Ç–∞–µ—Ç' : '‚è∏Ô∏è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}\n`;
                
                document.getElementById('runtimeOutput').innerHTML = `
                    <pre>${output}</pre>
                `;
                
                updateRuntimeStats();
            }
        }
        
        function updateRuntimeStats() {
            if (runtimeInstance) {
                const state = runtimeInstance.getState();
                
                document.getElementById('rtSprites').textContent = 
                    Object.keys(state.sprites).length;
                document.getElementById('rtVariables').textContent = 
                    Object.keys(state.variables).length;
                document.getElementById('rtFrames').textContent = state.frameCount;
                document.getElementById('rtStatus').textContent = 
                    state.isRunning ? '‚ñ∂Ô∏è' : '‚è∏Ô∏è';
            }
        }
        
        function updateRuntimeConsole() {
            const consoleElement = document.getElementById('runtimeConsole');
            if (consoleOutput.length > 0) {
                consoleElement.textContent = consoleOutput.join('\n');
                consoleElement.scrollTop = consoleElement.scrollHeight;
            } else {
                consoleElement.textContent = '[–ö–æ–Ω—Å–æ–ª—å –±—É–¥–µ—Ç –∑–¥–µ—Å—å]';
            }
        }
        
        function clearRuntimeOutput() {
            consoleOutput = [];
            updateRuntimeConsole();
            document.getElementById('runtimeOutput').innerHTML = `
                <pre>–í—ã–≤–æ–¥ –æ—á–∏—â–µ–Ω</pre>
            `;
        }
        
        // ==================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        
        function loadExample(name) {
            if (examples[name]) {
                document.getElementById('codeInput').value = examples[name];
                
                // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–∞
                setTimeout(runParser, 100);
                
                // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ runtime –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞
                if (name === 'simple') {
                    setTimeout(runRuntime, 300);
                }
            }
        }
        
        function clearAll() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã?')) {
                document.getElementById('codeInput').value = '';
                document.getElementById('parserResult').innerHTML = `
                    <div class="success">–ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é</div>
                `;
                document.getElementById('astOutput').textContent = '–ó–¥–µ—Å—å –±—É–¥–µ—Ç –¥–µ—Ä–µ–≤–æ —Ä–∞–∑–±–æ—Ä–∞ (AST)...';
                document.getElementById('runtimeOutput').innerHTML = `
                    <pre>–ó–¥–µ—Å—å –±—É–¥–µ—Ç –≤—ã–≤–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã...</pre>
                `;
                consoleOutput = [];
                updateRuntimeConsole();
                
                // –°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                document.getElementById('statLines').textContent = '0';
                document.getElementById('statTime').textContent = '0';
                document.getElementById('statSprites').textContent = '0';
                document.getElementById('statFunctions').textContent = '0';
                
                document.getElementById('rtSprites').textContent = '0';
                document.getElementById('rtVariables').textContent = '0';
                document.getElementById('rtFrames').textContent = '0';
                document.getElementById('rtStatus').textContent = '‚è∏Ô∏è';
                
                if (runtimeInstance) {
                    runtimeInstance.stop();
                    runtimeInstance = null;
                }
            }
        }
        
        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
        
        window.addEventListener('load', function() {
            console.log('üéÆ Gamelang IDE –∑–∞–≥—Ä—É–∂–µ–Ω!');
            console.log('–ü–∞—Ä—Å–µ—Ä –∏ Runtime –≥–æ—Ç–æ–≤—ã –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é.');
            
            // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            setTimeout(runParser, 1000);
        });
    </script>
</body>
</html>